# æˆ˜æ–—æœºæ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunshansj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://gitee.com/qunmasj/projects)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€ç°ä»£æˆ˜äº‰çš„ä¸æ–­æ¼”å˜ï¼Œç©ºä¸­ä½œæˆ˜çš„åœ°ä½æ„ˆå‘é‡è¦ï¼Œæˆ˜æ–—æœºä½œä¸ºç©ºä¸­åŠ›é‡çš„æ ¸å¿ƒï¼Œæ‰¿æ‹…ç€åˆ¶ç©ºæƒäº‰å¤ºã€å¯¹åœ°æ‰“å‡»ç­‰å¤šé‡ä»»åŠ¡ã€‚å› æ­¤ï¼Œå¿«é€Ÿã€å‡†ç¡®åœ°æ£€æµ‹å’Œè¯†åˆ«æˆ˜æ–—æœºåœ¨å†›äº‹ä¾¦å¯Ÿã€æˆ˜åœºç›‘æ§ä»¥åŠæŒ‡æŒ¥å†³ç­–ä¸­å…·æœ‰é‡è¦æ„ä¹‰ã€‚ä¼ ç»Ÿçš„æˆ˜æ–—æœºæ£€æµ‹æ–¹æ³•å¾€å¾€ä¾èµ–äºäººå·¥è§‚å¯Ÿå’Œç®€å•çš„å›¾åƒå¤„ç†æŠ€æœ¯ï¼Œå­˜åœ¨ç€æ•ˆç‡ä½ã€å‡†ç¡®æ€§å·®ç­‰é—®é¢˜ã€‚éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„è¿…çŒ›å‘å±•ï¼ŒåŸºäºå·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰çš„ç›®æ ‡æ£€æµ‹ç®—æ³•é€æ¸æˆä¸ºç ”ç©¶çƒ­ç‚¹ï¼Œå…¶ä¸­YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—ç®—æ³•å› å…¶é«˜æ•ˆæ€§å’Œå®æ—¶æ€§è¢«å¹¿æ³›åº”ç”¨äºç›®æ ‡æ£€æµ‹é¢†åŸŸã€‚

YOLOv8ä½œä¸ºYOLOç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥æå‡äº†ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé€Ÿåº¦ã€‚ç„¶è€Œï¼Œé’ˆå¯¹ç‰¹å®šåœºæ™¯ï¼Œå¦‚æˆ˜æ–—æœºæ£€æµ‹ï¼ŒYOLOv8çš„æ€§èƒ½ä»æœ‰å¾…æå‡ã€‚ä¸ºäº†å®ç°æ›´é«˜æ•ˆçš„æˆ˜æ–—æœºæ£€æµ‹ç³»ç»Ÿï¼Œæœ¬ç ”ç©¶åŸºäºæ”¹è¿›YOLOv8ç®—æ³•ï¼Œç»“åˆç‰¹å®šçš„æ•°æ®é›†è¿›è¡Œä¼˜åŒ–ï¼Œæ—¨åœ¨æé«˜æˆ˜æ–—æœºçš„æ£€æµ‹å‡†ç¡®ç‡å’Œå®æ—¶æ€§ã€‚

æœ¬ç ”ç©¶æ‰€ä½¿ç”¨çš„æ•°æ®é›†åŒ…å«5800å¼ æˆ˜æ–—æœºå›¾åƒï¼Œä¸”ç±»åˆ«æ•°é‡ä¸º1ï¼Œä¸“æ³¨äºæˆ˜æ–—æœºè¿™ä¸€ç‰¹å®šç›®æ ‡ã€‚è¿™ä¸€æ•°æ®é›†çš„æ„å»ºä¸ä»…ä¸ºç®—æ³•çš„è®­ç»ƒæä¾›äº†ä¸°å¯Œçš„æ ·æœ¬ï¼Œä¹Ÿä¸ºåç»­çš„æ¨¡å‹è¯„ä¼°å’ŒéªŒè¯å¥ å®šäº†åŸºç¡€ã€‚é€šè¿‡å¯¹æ•°æ®é›†çš„æ·±å…¥åˆ†æï¼Œå¯ä»¥å‘ç°æˆ˜æ–—æœºåœ¨ä¸åŒåœºæ™¯ã€ä¸åŒå…‰ç…§æ¡ä»¶ä¸‹çš„å¤–è§‚ç‰¹å¾å’Œå˜åŒ–ï¼Œè¿™ä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†å¤šæ ·æ€§å’Œå¤æ‚æ€§ï¼Œæœ‰åŠ©äºæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚

æ”¹è¿›YOLOv8çš„æˆ˜æ–—æœºæ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶æ„ä¹‰åœ¨äºï¼Œä¸ä»…å¯ä»¥ä¸ºå†›äº‹é¢†åŸŸæä¾›é«˜æ•ˆçš„æˆ˜æ–—æœºç›‘æµ‹æ‰‹æ®µï¼Œè¿˜èƒ½å¤Ÿä¸ºå…¶ä»–é¢†åŸŸçš„ç›®æ ‡æ£€æµ‹æä¾›å€Ÿé‰´ã€‚é€šè¿‡å¼•å…¥æ”¹è¿›çš„ç®—æ³•æ¶æ„å’Œè®­ç»ƒç­–ç•¥ï¼Œå¯ä»¥æœ‰æ•ˆæå‡æ¨¡å‹åœ¨å¤æ‚ç¯å¢ƒä¸‹çš„æ£€æµ‹æ€§èƒ½ï¼Œé™ä½è¯¯æ£€ç‡å’Œæ¼æ£€ç‡ã€‚æ­¤å¤–ï¼Œç ”ç©¶æˆæœè¿˜å¯ä»¥ä¸ºæ— äººæœºã€å«æ˜Ÿå›¾åƒåˆ†æç­‰ç›¸å…³åº”ç”¨æä¾›æŠ€æœ¯æ”¯æŒï¼Œæ¨åŠ¨ç›¸å…³é¢†åŸŸçš„æ™ºèƒ½åŒ–å‘å±•ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æˆ˜æ–—æœºæ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œä¸ä»…å…·æœ‰é‡è¦çš„ç†è®ºä»·å€¼ï¼Œè¿˜å…·å¤‡å¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚é€šè¿‡æœ¬ç ”ç©¶çš„æ·±å…¥å¼€å±•ï¼ŒæœŸæœ›èƒ½å¤Ÿä¸ºæˆ˜æ–—æœºçš„å¿«é€Ÿè¯†åˆ«å’Œç›‘æµ‹æä¾›ä¸€ç§æ–°çš„è§£å†³æ–¹æ¡ˆï¼ŒåŠ©åŠ›ç°ä»£æˆ˜äº‰ä¸­ç©ºä¸­åŠ›é‡çš„æœ‰æ•ˆè¿ç”¨ï¼ŒåŒæ—¶æ¨åŠ¨ç›®æ ‡æ£€æµ‹æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥ä¸åˆ›æ–°ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1dG4oeLEX2/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 1
names: ['fighter']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨ç°ä»£è®¡ç®—æœºè§†è§‰é¢†åŸŸï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­ï¼Œæ•°æ®é›†çš„è´¨é‡å’Œå¤šæ ·æ€§ç›´æ¥å½±å“åˆ°æ¨¡å‹çš„æ€§èƒ½å’Œåº”ç”¨æ•ˆæœã€‚æœ¬ç ”ç©¶æ‰€ä½¿ç”¨çš„æ•°æ®é›†åä¸ºâ€œfightersâ€ï¼Œä¸“é—¨ç”¨äºè®­ç»ƒå’Œæ”¹è¿›YOLOv8æ¨¡å‹ï¼Œä»¥å®ç°é«˜æ•ˆçš„æˆ˜æ–—æœºæ£€æµ‹ç³»ç»Ÿã€‚è¯¥æ•°æ®é›†çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†è§£å†³æˆ˜æ–—æœºæ£€æµ‹ä¸­å­˜åœ¨çš„å„ç§æŒ‘æˆ˜ï¼ŒåŒ…æ‹¬èƒŒæ™¯å¤æ‚æ€§ã€å…‰ç…§å˜åŒ–ä»¥åŠä¸åŒè§’åº¦å’Œè·ç¦»ä¸‹çš„ç›®æ ‡è¯†åˆ«ç­‰é—®é¢˜ã€‚

â€œfightersâ€æ•°æ®é›†çš„ç±»åˆ«æ•°é‡ä¸º1ï¼Œå…·ä½“ç±»åˆ«ä¸ºâ€œfighterâ€ã€‚è¿™ä¸€å•ä¸€ç±»åˆ«çš„è®¾ç½®ä½¿å¾—æ•°æ®é›†åœ¨ä¸“æ³¨äºæˆ˜æ–—æœºæ£€æµ‹çš„åŒæ—¶ï¼Œèƒ½å¤Ÿæ·±å…¥æŒ–æ˜è¯¥ç±»åˆ«å†…çš„å¤šæ ·æ€§å’Œå¤æ‚æ€§ã€‚å°½ç®¡ç±»åˆ«æ•°é‡æœ‰é™ï¼Œä½†â€œfightersâ€æ•°æ®é›†åŒ…å«äº†å¤§é‡çš„æˆ˜æ–—æœºå›¾åƒï¼Œæ¶µç›–äº†ä¸åŒå‹å·ã€ä¸åŒç¯å¢ƒä¸‹çš„æˆ˜æ–—æœºã€‚è¿™ç§å¤šæ ·æ€§ä¸ä»…æé«˜äº†æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œè¿˜ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿåœ¨å„ç§å®é™…åº”ç”¨åœºæ™¯ä¸­è¡¨ç°å‡ºè‰²ã€‚

æ•°æ®é›†ä¸­çš„å›¾åƒæ¥æºå¹¿æ³›ï¼Œæ¶µç›–äº†ä¸åŒå›½å®¶å’Œåœ°åŒºçš„æˆ˜æ–—æœºï¼ŒåŒ…æ‹¬ä½†ä¸é™äºç°ä»£æˆ˜æ–—æœºå’Œå†å²æˆ˜æ–—æœºã€‚è¿™äº›å›¾åƒçš„æ‹æ‘„æ¡ä»¶å„å¼‚ï¼Œæ—¢æœ‰æ™´å¤©ã€é˜´å¤©çš„è‡ªç„¶å…‰ç…§æ¡ä»¶ï¼Œä¹Ÿæœ‰å¤œé—´å’Œäººå·¥å…‰æºä¸‹çš„åœºæ™¯ã€‚è¿™ç§ä¸°å¯Œçš„å›¾åƒæ¥æºç¡®ä¿äº†æ¨¡å‹åœ¨é¢å¯¹çœŸå®ä¸–ç•Œä¸­å„ç§å¤æ‚ç¯å¢ƒæ—¶ï¼Œèƒ½å¤Ÿä¿æŒè¾ƒé«˜çš„æ£€æµ‹ç²¾åº¦ã€‚

ä¸ºäº†æé«˜æ¨¡å‹çš„è®­ç»ƒæ•ˆæœï¼Œæ•°æ®é›†ä¸­çš„å›¾åƒç»è¿‡ç²¾å¿ƒæ ‡æ³¨ï¼Œç¡®ä¿æ¯ä¸€å¼ å›¾åƒä¸­çš„æˆ˜æ–—æœºç›®æ ‡éƒ½è¢«å‡†ç¡®æ¡†å®šã€‚æ ‡æ³¨ä¿¡æ¯åŒ…æ‹¬ç›®æ ‡çš„è¾¹ç•Œæ¡†ä½ç½®ä»¥åŠç›¸åº”çš„ç±»åˆ«æ ‡ç­¾ï¼Œè¿™ä¸ºYOLOv8æ¨¡å‹çš„è®­ç»ƒæä¾›äº†å¯é çš„ç›‘ç£ä¿¡å·ã€‚æ­¤å¤–ï¼Œæ•°æ®é›†è¿˜åŒ…å«äº†ä¸€äº›æŒ‘æˆ˜æ€§æ ·æœ¬ï¼Œä¾‹å¦‚æˆ˜æ–—æœºåœ¨ä¸åŒé€Ÿåº¦ä¸‹çš„é£è¡ŒçŠ¶æ€ã€ä¸åŒçš„èƒŒæ™¯å¹²æ‰°ç­‰ï¼Œä»¥å¢å¼ºæ¨¡å‹çš„é²æ£’æ€§ã€‚

åœ¨æ•°æ®é¢„å¤„ç†é˜¶æ®µï¼Œç ”ç©¶å›¢é˜Ÿå¯¹â€œfightersâ€æ•°æ®é›†è¿›è¡Œäº†å¤šç§å¢å¼ºå¤„ç†ï¼ŒåŒ…æ‹¬å›¾åƒç¼©æ”¾ã€æ—‹è½¬ã€ç¿»è½¬ä»¥åŠé¢œè‰²è°ƒæ•´ç­‰ã€‚è¿™äº›å¢å¼ºæŠ€æœ¯ä¸ä»…å¢åŠ äº†æ•°æ®é›†çš„å¤šæ ·æ€§ï¼Œè¿˜æœ‰æ•ˆé˜²æ­¢äº†æ¨¡å‹çš„è¿‡æ‹Ÿåˆç°è±¡ï¼Œä½¿å¾—è®­ç»ƒå‡ºçš„æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°é€‚åº”æœªè§è¿‡çš„æ ·æœ¬ã€‚

æ€»ä¹‹ï¼Œâ€œfightersâ€æ•°æ®é›†ä¸ºè®­ç»ƒå’Œæ”¹è¿›YOLOv8æˆ˜æ–—æœºæ£€æµ‹ç³»ç»Ÿæä¾›äº†åšå®çš„åŸºç¡€ã€‚é€šè¿‡ä¸°å¯Œçš„å›¾åƒæ ·æœ¬å’Œç²¾ç¡®çš„æ ‡æ³¨ä¿¡æ¯ï¼Œè¯¥æ•°æ®é›†ä¸ä»…æå‡äº†æ¨¡å‹çš„æ£€æµ‹èƒ½åŠ›ï¼Œä¹Ÿä¸ºæœªæ¥åœ¨å†›äº‹èˆªç©ºã€å®‰é˜²ç›‘æ§ç­‰é¢†åŸŸçš„åº”ç”¨å¥ å®šäº†è‰¯å¥½çš„åŸºç¡€ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥å’Œæ•°æ®é›†çš„ä¸æ–­å®Œå–„ï¼Œæˆ˜æ–—æœºæ£€æµ‹ç³»ç»Ÿçš„å‡†ç¡®æ€§å’Œå®ç”¨æ€§å°†ä¼šè¿›ä¸€æ­¥æå‡ï¼Œä¸ºç›¸å…³é¢†åŸŸçš„ç ”ç©¶å’Œåº”ç”¨æä¾›æ›´å¤šå¯èƒ½æ€§ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOv8ä½œä¸ºç›®æ ‡æ£€æµ‹é¢†åŸŸçš„æœ€æ–°ä»£è¡¨ï¼Œç»§æ‰¿å¹¶å‘å±•äº†YOLOç³»åˆ—æ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³ï¼Œæ—¨åœ¨é€šè¿‡é«˜æ•ˆçš„ç‰¹å¾æå–å’Œç²¾å‡†çš„ç›®æ ‡æ£€æµ‹ï¼Œæ»¡è¶³ç°ä»£è®¡ç®—æœºè§†è§‰åº”ç”¨å¯¹é€Ÿåº¦å’Œå‡†ç¡®åº¦çš„åŒé‡éœ€æ±‚ã€‚è¯¥æ¨¡å‹çš„è®¾è®¡å›´ç»•ç€ä¸‰ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†å±•å¼€ï¼šBackboneã€Neckå’ŒHeadï¼Œè¿™ä¸‰è€…å…±åŒæ„æˆäº†YOLOv8çš„æ•´ä½“æ¶æ„ï¼Œä½¿å…¶åœ¨å¤„ç†å¤æ‚å›¾åƒæ—¶å±•ç°å‡ºå“è¶Šçš„æ€§èƒ½ã€‚

åœ¨Backboneéƒ¨åˆ†ï¼ŒYOLOv8å¼•å…¥äº†CSPDarknetï¼ˆCross Stage Partial Darknetï¼‰ç»“æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªç»è¿‡ä¼˜åŒ–çš„æ·±åº¦å­¦ä¹ ç½‘ç»œï¼Œæ—¨åœ¨é«˜æ•ˆæå–å›¾åƒç‰¹å¾ã€‚ä¸å‰ä»£æ¨¡å‹YOLOv5ç›¸æ¯”ï¼ŒYOLOv8é‡‡ç”¨äº†C2fæ¨¡å—æ›¿ä»£äº†C3æ¨¡å—ï¼ŒC2fæ¨¡å—é€šè¿‡å°†è¾“å…¥ç‰¹å¾å›¾åˆ†ä¸ºä¸¤ä¸ªåˆ†æ”¯ï¼Œåˆ†åˆ«ç»è¿‡å·ç§¯å±‚è¿›è¡Œé™ç»´å¤„ç†ï¼Œä»è€Œå®ç°äº†æ›´ä¸°å¯Œçš„ç‰¹å¾è¡¨è¾¾ã€‚è¿™ç§è®¾è®¡ä¸ä»…å¢å¼ºäº†æ¨¡å‹çš„æ¢¯åº¦æµä¿¡æ¯ï¼Œè¿˜æé«˜äº†ç‰¹å¾æå–çš„æ•ˆç‡ã€‚æ­¤å¤–ï¼ŒYOLOv8åœ¨Backboneä¸­ä½¿ç”¨äº†v8_C2fBottleneckå±‚ï¼Œè¿›ä¸€æ­¥æå‡äº†ç‰¹å¾å›¾çš„ç»´åº¦ï¼Œä½¿å¾—æ¨¡å‹åœ¨æ•æ‰å›¾åƒç»†èŠ‚æ—¶æ›´åŠ çµæ´»ã€‚

Neckéƒ¨åˆ†åˆ™é‡‡ç”¨äº†ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œï¼ˆFPNï¼‰å’Œè·¯å¾„èšåˆç½‘ç»œï¼ˆPANï¼‰çš„ç»„åˆç»“æ„ï¼Œè¿™ä¸€è®¾è®¡æ—¨åœ¨æ›´å¥½åœ°èåˆä¸åŒå±‚æ¬¡çš„ç‰¹å¾ä¿¡æ¯ã€‚é€šè¿‡å¤šå±‚å·ç§¯å’Œæ± åŒ–æ“ä½œï¼ŒNeckéƒ¨åˆ†æœ‰æ•ˆåœ°å‹ç¼©äº†ç‰¹å¾å›¾ï¼ŒåŒæ—¶ä¿ç•™äº†ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä½¿å¾—æ¨¡å‹åœ¨è¿›è¡Œç›®æ ‡æ£€æµ‹æ—¶èƒ½å¤Ÿæ›´å‡†ç¡®åœ°å®šä½ç›®æ ‡ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒYOLOv8è¿˜å¼•å…¥äº†å¿«é€Ÿç©ºé—´é‡‘å­—å¡”æ± åŒ–ï¼ˆSPPFï¼‰ç»“æ„ï¼Œä»¥æé«˜å¯¹ä¸åŒå°ºåº¦ç‰¹å¾çš„æå–èƒ½åŠ›ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–äº†æ¨¡å‹çš„è®¡ç®—æ•ˆç‡ã€‚

åœ¨Headéƒ¨åˆ†ï¼ŒYOLOv8é‡‡ç”¨äº†æ— é”šæ¡†ï¼ˆAnchor-Freeï¼‰æ£€æµ‹æ–¹å¼ï¼Œç›´æ¥é¢„æµ‹ç›®æ ‡çš„ä¸­å¿ƒç‚¹å’Œå®½é«˜æ¯”ä¾‹ã€‚è¿™ä¸€åˆ›æ–°è®¾è®¡æ˜¾è‘—å‡å°‘äº†å¯¹Anchoræ¡†çš„ä¾èµ–ï¼Œæå‡äº†æ£€æµ‹é€Ÿåº¦å’Œå‡†ç¡®åº¦ã€‚é€šè¿‡å¼•å…¥ä»»åŠ¡å¯¹é½å­¦ä¹ ï¼ˆTask Alignment Learning, TALï¼‰ï¼ŒYOLOv8èƒ½å¤Ÿæ›´å¥½åœ°åŒºåˆ†æ­£è´Ÿæ ·æœ¬ï¼Œå¹¶åˆ©ç”¨åˆ†ç±»åˆ†æ•°å’ŒIOUçš„é«˜æ¬¡å¹‚ä¹˜ç§¯ä½œä¸ºè¡¡é‡ä»»åŠ¡å¯¹é½ç¨‹åº¦çš„æŒ‡æ ‡ï¼Œä»è€Œå®ç°æ›´é«˜çš„å®šä½ç²¾åº¦å’Œåˆ†ç±»å‡†ç¡®åº¦ã€‚

YOLOv8åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯¹æ•°æ®å¢å¼ºç­–ç•¥è¿›è¡Œäº†ä¼˜åŒ–ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨Mosaicæ•°æ®å¢å¼ºæ—¶ï¼Œæ¨¡å‹åœ¨è®­ç»ƒçš„æœ€å10ä¸ªepochåœæ­¢ä½¿ç”¨è¯¥ç­–ç•¥ï¼Œä»¥é¿å…å¯¹æ•°æ®çœŸå®åˆ†å¸ƒçš„å¹²æ‰°ã€‚è¿™ä¸€ç»†èŠ‚ä½“ç°äº†YOLOv8åœ¨è®¾è®¡æ—¶å¯¹æ¨¡å‹é²æ£’æ€§å’Œæ³›åŒ–èƒ½åŠ›çš„æ·±åˆ»ç†è§£ã€‚

æ•´ä½“è€Œè¨€ï¼ŒYOLOv8çš„è®¾è®¡ç†å¿µæ˜¯é€šè¿‡å¼•å…¥æ–°çš„ç½‘ç»œç»“æ„å’Œç®—æ³•ä¼˜åŒ–ï¼Œæå‡æ¨¡å‹çš„æ€§èƒ½å’Œçµæ´»æ€§ã€‚ä¸ä¹‹å‰çš„YOLOç‰ˆæœ¬ç›¸æ¯”ï¼ŒYOLOv8åœ¨æ¨ç†é€Ÿåº¦å’Œæ£€æµ‹ç²¾åº¦ä¸Šå‡æœ‰æ˜¾è‘—æå‡ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤æ‚åœºæ™¯å’Œå¤šç›®æ ‡æ£€æµ‹ä»»åŠ¡æ—¶ï¼Œè¡¨ç°å°¤ä¸ºçªå‡ºã€‚å…¶è½»é‡åŒ–çš„ç‰¹å¾æå–å’Œé«˜æ•ˆçš„ç›®æ ‡æ£€æµ‹èƒ½åŠ›ï¼Œä½¿å¾—YOLOv8åœ¨å®æ—¶åº”ç”¨ä¸­å…·å¤‡äº†æ›´å¼ºçš„ç«äº‰åŠ›ã€‚

YOLOv8çš„å¤šç§å°ºå¯¸è®¾ç½®ä½¿å¾—å…¶åœ¨ä¸åŒç¡¬ä»¶å¹³å°ä¸Šå‡èƒ½çµæ´»éƒ¨ç½²ï¼Œé€‚åº”å„ç§åº”ç”¨åœºæ™¯çš„éœ€æ±‚ã€‚æ— è®ºæ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè¿›è¡Œå®æ—¶ç›®æ ‡æ£€æµ‹ï¼Œè¿˜æ˜¯åœ¨å¤§å‹æœåŠ¡å™¨ä¸Šå¤„ç†é«˜åˆ†è¾¨ç‡å›¾åƒï¼ŒYOLOv8éƒ½å±•ç°å‡ºäº†æä½³çš„é€‚åº”æ€§å’Œæ€§èƒ½ã€‚è¿™ä¸€ç³»åˆ—æ”¹è¿›å’Œåˆ›æ–°ï¼Œä½¿å¾—YOLOv8ä¸ä»…åœ¨å­¦æœ¯ç•Œå¼•èµ·äº†å¹¿æ³›å…³æ³¨ï¼Œä¹Ÿåœ¨å·¥ä¸šç•Œå¾—åˆ°äº†å¹¿æ³›åº”ç”¨ï¼Œæˆä¸ºç›®æ ‡æ£€æµ‹é¢†åŸŸçš„ä¸€ä¸ªé‡è¦é‡Œç¨‹ç¢‘ã€‚

æ€»ä¹‹ï¼ŒYOLOv8ä»¥å…¶é«˜æ•ˆçš„ç‰¹å¾æå–æœºåˆ¶ã€çµæ´»çš„ç½‘ç»œç»“æ„å’Œåˆ›æ–°çš„æ£€æµ‹æ–¹æ³•ï¼Œæ¨åŠ¨äº†ç›®æ ‡æ£€æµ‹æŠ€æœ¯çš„å‘å±•ï¼Œå±•ç°äº†è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„æ— é™å¯èƒ½ã€‚é€šè¿‡ä¸æ–­çš„ä¼˜åŒ–å’Œè¿­ä»£ï¼ŒYOLOv8ä¸ä»…ä¸ºç ”ç©¶äººå‘˜æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä¹Ÿä¸ºå®é™…åº”ç”¨æä¾›äº†å¯é çš„è§£å†³æ–¹æ¡ˆï¼Œè¿›ä¸€æ­¥æ¨åŠ¨äº†æ™ºèƒ½è§†è§‰æŠ€æœ¯çš„è¿›æ­¥ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 code\ultralytics\models\nas\__init__.py

ä¸‹é¢æ˜¯å¯¹ç»™å®šä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œæç‚¼å’Œè¯¦ç»†æ³¨é‡Šçš„ç»“æœï¼š

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license

# ä»å½“å‰åŒ…ä¸­å¯¼å…¥ NAS æ¨¡å‹ç±»
from .model import NAS

# ä»å½“å‰åŒ…ä¸­å¯¼å…¥ç”¨äºé¢„æµ‹çš„ NASPredictor ç±»
from .predict import NASPredictor

# ä»å½“å‰åŒ…ä¸­å¯¼å…¥ç”¨äºéªŒè¯çš„ NASValidator ç±»
from .val import NASValidator

# å®šä¹‰å½“å‰æ¨¡å—çš„å…¬å…±æ¥å£ï¼ŒåŒ…å« NASPredictorã€NASValidator å’Œ NAS ç±»
__all__ = "NASPredictor", "NASValidator", "NAS"
```

### ä»£ç åˆ†æä¸æ³¨é‡Šï¼š

1. **æ¨¡å—å¯¼å…¥**ï¼š
   - `from .model import NAS`ï¼šä»å½“å‰åŒ…ï¼ˆå³åŒ…å«è¯¥ä»£ç çš„ç›®å½•ï¼‰ä¸­å¯¼å…¥ `NAS` ç±»ï¼Œé€šå¸¸è¿™ä¸ªç±»æ˜¯ç”¨äºå®šä¹‰ YOLO æ¨¡å‹çš„ç»“æ„å’Œå‚æ•°ã€‚
   - `from .predict import NASPredictor`ï¼šå¯¼å…¥ `NASPredictor` ç±»ï¼Œè¯¥ç±»å¯èƒ½è´Ÿè´£ä½¿ç”¨å·²è®­ç»ƒçš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œå¤„ç†è¾“å…¥æ•°æ®å¹¶è¿”å›é¢„æµ‹ç»“æœã€‚
   - `from .val import NASValidator`ï¼šå¯¼å…¥ `NASValidator` ç±»ï¼Œè¯¥ç±»å¯èƒ½ç”¨äºæ¨¡å‹éªŒè¯ï¼Œè¯„ä¼°æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„è¡¨ç°ã€‚

2. **å…¬å…±æ¥å£å®šä¹‰**ï¼š
   - `__all__ = "NASPredictor", "NASValidator", "NAS"`ï¼šè¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šå˜é‡ï¼Œç”¨äºå®šä¹‰å½“ä½¿ç”¨ `from module import *` æ—¶ï¼Œå“ªäº›ç±»æˆ–å‡½æ•°ä¼šè¢«å¯¼å…¥ã€‚è¿™é‡ŒæŒ‡å®šäº† `NASPredictor`ã€`NASValidator` å’Œ `NAS` è¿™ä¸‰ä¸ªç±»ä¸ºå…¬å…±æ¥å£ï¼Œè¡¨æ˜å®ƒä»¬æ˜¯è¯¥æ¨¡å—çš„ä¸»è¦åŠŸèƒ½éƒ¨åˆ†ã€‚

### æ€»ç»“ï¼š
è¿™æ®µä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯å¯¼å…¥ YOLO æ¨¡å‹ç›¸å…³çš„ç±»ï¼Œå¹¶å®šä¹‰äº†æ¨¡å—çš„å…¬å…±æ¥å£ï¼Œæ–¹ä¾¿å…¶ä»–æ¨¡å—æˆ–ç”¨æˆ·ä½¿ç”¨è¿™äº›åŠŸèƒ½ã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯Ultralytics YOLOé¡¹ç›®ä¸­çš„ä¸€ä¸ªåˆå§‹åŒ–æ–‡ä»¶ï¼Œä½äº`code/ultralytics/models/nas/`ç›®å½•ä¸‹ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å®šä¹‰æ¨¡å—çš„å…¬å…±æ¥å£ï¼Œä¾¿äºå…¶ä»–æ¨¡å—æˆ–æ–‡ä»¶å¯¼å…¥ä½¿ç”¨ã€‚

æ–‡ä»¶çš„å¼€å¤´æœ‰ä¸€è¡Œæ³¨é‡Šï¼Œæ ‡æ˜äº†è¿™æ˜¯Ultralytics YOLOé¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶å£°æ˜äº†å…¶ä½¿ç”¨çš„AGPL-3.0è®¸å¯è¯ã€‚è¿™è¡¨æ˜è¯¥é¡¹ç›®æ˜¯å¼€æºçš„ï¼Œå¹¶ä¸”ä½¿ç”¨è€…éœ€è¦éµå¾ªç›¸åº”çš„è®¸å¯è¯æ¡æ¬¾ã€‚

æ¥ä¸‹æ¥ï¼Œæ–‡ä»¶é€šè¿‡ç›¸å¯¹å¯¼å…¥çš„æ–¹å¼å¼•å…¥äº†ä¸‰ä¸ªç±»ï¼š`NAS`ã€`NASPredictor`å’Œ`NASValidator`ã€‚è¿™äº›ç±»åˆ†åˆ«æ¥è‡ªäºåŒä¸€ç›®å½•ä¸‹çš„`model.py`ã€`predict.py`å’Œ`val.py`æ–‡ä»¶ã€‚`NAS`ç±»å¯èƒ½æ˜¯ä¸ç¥ç»æ¶æ„æœç´¢ï¼ˆNeural Architecture Searchï¼‰ç›¸å…³çš„æ¨¡å‹å®šä¹‰ï¼Œè€Œ`NASPredictor`å’Œ`NASValidator`åˆ™å¯èƒ½æ˜¯ç”¨äºæ¨¡å‹é¢„æµ‹å’ŒéªŒè¯çš„å·¥å…·ç±»ã€‚

æœ€åï¼Œ`__all__`å˜é‡è¢«å®šä¹‰ä¸ºä¸€ä¸ªå…ƒç»„ï¼ŒåŒ…å«äº†ä¸‰ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ†åˆ«æ˜¯"NASPredictor"ã€"NASValidator"å’Œ"NAS"ã€‚è¿™ä¸ªå˜é‡çš„ä½œç”¨æ˜¯æŒ‡æ˜å½“ä½¿ç”¨`from module import *`è¯­å¥æ—¶ï¼Œåº”è¯¥å¯¼å…¥å“ªäº›åç§°ã€‚è¿™æ˜¯ä¸€ç§æ§åˆ¶æ¨¡å—å…¬å…±æ¥å£çš„æ–¹å¼ï¼Œç¡®ä¿åªæœ‰æŒ‡å®šçš„ç±»æˆ–å‡½æ•°èƒ½å¤Ÿè¢«å¤–éƒ¨è®¿é—®ï¼Œä»è€Œä¿æŠ¤æ¨¡å—çš„å†…éƒ¨å®ç°ç»†èŠ‚ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªåˆå§‹åŒ–æ–‡ä»¶çš„åŠŸèƒ½æ˜¯å°†ç›¸å…³çš„ç±»ç»„ç»‡åœ¨ä¸€èµ·ï¼Œæä¾›ä¸€ä¸ªç®€æ´çš„æ¥å£ä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨ï¼Œä¾¿äºä»£ç çš„ç»“æ„åŒ–å’Œç®¡ç†ã€‚

#### 11.2 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\backbone\VanillaNet.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å¹¶æ·»åŠ è¯¦ç»†ä¸­æ–‡æ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import torch
import torch.nn as nn
import torch.nn.functional as F
from timm.layers import weight_init

# å®šä¹‰æ¿€æ´»å‡½æ•°ç±»
class Activation(nn.ReLU):
    def __init__(self, dim, act_num=3, deploy=False):
        super(Activation, self).__init__()
        self.deploy = deploy  # æ˜¯å¦ä¸ºéƒ¨ç½²æ¨¡å¼
        # åˆå§‹åŒ–æƒé‡å’Œåç½®
        self.weight = torch.nn.Parameter(torch.randn(dim, 1, act_num * 2 + 1, act_num * 2 + 1))
        self.bias = None
        self.bn = nn.BatchNorm2d(dim, eps=1e-6)  # æ‰¹å½’ä¸€åŒ–
        self.dim = dim
        self.act_num = act_num
        weight_init.trunc_normal_(self.weight, std=.02)  # æƒé‡åˆå§‹åŒ–

    def forward(self, x):
        # å‰å‘ä¼ æ’­
        if self.deploy:
            return F.conv2d(
                super(Activation, self).forward(x), 
                self.weight, self.bias, padding=(self.act_num * 2 + 1) // 2, groups=self.dim)
        else:
            return self.bn(F.conv2d(
                super(Activation, self).forward(x),
                self.weight, padding=self.act_num, groups=self.dim))

    def switch_to_deploy(self):
        # åˆ‡æ¢åˆ°éƒ¨ç½²æ¨¡å¼ï¼Œèåˆæ‰¹å½’ä¸€åŒ–
        if not self.deploy:
            kernel, bias = self._fuse_bn_tensor(self.weight, self.bn)
            self.weight.data = kernel
            self.bias = torch.nn.Parameter(torch.zeros(self.dim))
            self.bias.data = bias
            self.__delattr__('bn')  # åˆ é™¤bnå±æ€§
            self.deploy = True

    def _fuse_bn_tensor(self, weight, bn):
        # èåˆæƒé‡å’Œæ‰¹å½’ä¸€åŒ–å‚æ•°
        kernel = weight
        running_mean = bn.running_mean
        running_var = bn.running_var
        gamma = bn.weight
        beta = bn.bias
        eps = bn.eps
        std = (running_var + eps).sqrt()
        t = (gamma / std).reshape(-1, 1, 1, 1)
        return kernel * t, beta + (0 - running_mean) * gamma / std

# å®šä¹‰åŸºæœ¬æ¨¡å—
class Block(nn.Module):
    def __init__(self, dim, dim_out, act_num=3, stride=2, deploy=False):
        super().__init__()
        self.deploy = deploy
        # æ ¹æ®æ˜¯å¦éƒ¨ç½²é€‰æ‹©ä¸åŒçš„å·ç§¯ç»“æ„
        if self.deploy:
            self.conv = nn.Conv2d(dim, dim_out, kernel_size=1)
        else:
            self.conv1 = nn.Sequential(
                nn.Conv2d(dim, dim, kernel_size=1),
                nn.BatchNorm2d(dim, eps=1e-6),
            )
            self.conv2 = nn.Sequential(
                nn.Conv2d(dim, dim_out, kernel_size=1),
                nn.BatchNorm2d(dim_out, eps=1e-6)
            )
        # æ± åŒ–å±‚
        self.pool = nn.MaxPool2d(stride) if stride != 1 else nn.Identity()
        self.act = Activation(dim_out, act_num)  # æ¿€æ´»å‡½æ•°

    def forward(self, x):
        # å‰å‘ä¼ æ’­
        if self.deploy:
            x = self.conv(x)
        else:
            x = self.conv1(x)
            x = F.leaky_relu(x, negative_slope=1)  # ä½¿ç”¨Leaky ReLUæ¿€æ´»
            x = self.conv2(x)

        x = self.pool(x)  # æ± åŒ–
        x = self.act(x)  # æ¿€æ´»
        return x

# å®šä¹‰VanillaNetæ¨¡å‹
class VanillaNet(nn.Module):
    def __init__(self, in_chans=3, num_classes=1000, dims=[96, 192, 384, 768], 
                 drop_rate=0, act_num=3, strides=[2, 2, 2, 1], deploy=False):
        super().__init__()
        self.deploy = deploy
        # åˆå§‹åŒ–steméƒ¨åˆ†
        if self.deploy:
            self.stem = nn.Sequential(
                nn.Conv2d(in_chans, dims[0], kernel_size=4, stride=4),
                Activation(dims[0], act_num)
            )
        else:
            self.stem1 = nn.Sequential(
                nn.Conv2d(in_chans, dims[0], kernel_size=4, stride=4),
                nn.BatchNorm2d(dims[0], eps=1e-6),
            )
            self.stem2 = nn.Sequential(
                nn.Conv2d(dims[0], dims[0], kernel_size=1, stride=1),
                nn.BatchNorm2d(dims[0], eps=1e-6),
                Activation(dims[0], act_num)
            )

        self.stages = nn.ModuleList()  # å­˜å‚¨å¤šä¸ªBlock
        for i in range(len(strides)):
            stage = Block(dim=dims[i], dim_out=dims[i + 1], act_num=act_num, stride=strides[i], deploy=deploy)
            self.stages.append(stage)

    def forward(self, x):
        # å‰å‘ä¼ æ’­
        if self.deploy:
            x = self.stem(x)
        else:
            x = self.stem1(x)
            x = F.leaky_relu(x, negative_slope=1)
            x = self.stem2(x)

        for stage in self.stages:
            x = stage(x)  # é€šè¿‡æ¯ä¸ªBlock
        return x

# ç¤ºä¾‹ï¼šåˆ›å»ºVanillaNetæ¨¡å‹å¹¶è¿›è¡Œå‰å‘ä¼ æ’­
if __name__ == '__main__':
    inputs = torch.randn((1, 3, 640, 640))  # è¾“å…¥æ•°æ®
    model = VanillaNet()  # åˆ›å»ºæ¨¡å‹
    pred = model(inputs)  # å‰å‘ä¼ æ’­
    print(pred.size())  # è¾“å‡ºé¢„æµ‹ç»“æœçš„å°ºå¯¸
```

### ä»£ç è¯´æ˜ï¼š
1. **Activationç±»**ï¼šè‡ªå®šä¹‰çš„æ¿€æ´»å‡½æ•°ç±»ï¼Œç»§æ‰¿è‡ª`nn.ReLU`ï¼Œå¹¶æ·»åŠ äº†æƒé‡å’Œåç½®çš„å¤„ç†ã€‚
2. **Blockç±»**ï¼šåŸºæœ¬æ¨¡å—ï¼ŒåŒ…å«å·ç§¯ã€æ‰¹å½’ä¸€åŒ–å’Œæ¿€æ´»å‡½æ•°ï¼Œæ”¯æŒéƒ¨ç½²æ¨¡å¼ã€‚
3. **VanillaNetç±»**ï¼šä¸»ç½‘ç»œç»“æ„ï¼ŒåŒ…å«å¤šä¸ªBlockå’Œsteméƒ¨åˆ†ï¼Œç”¨äºç‰¹å¾æå–ã€‚
4. **å‰å‘ä¼ æ’­**ï¼šåœ¨`VanillaNet`çš„`forward`æ–¹æ³•ä¸­ï¼Œè¾“å…¥æ•°æ®ç»è¿‡stemå’Œå¤šä¸ªBlockå¤„ç†ï¼Œæœ€ç»ˆè¾“å‡ºç‰¹å¾ã€‚

é€šè¿‡è¿™äº›æ³¨é‡Šï¼Œå¯ä»¥æ›´å¥½åœ°ç†è§£ä»£ç çš„ç»“æ„å’ŒåŠŸèƒ½ã€‚

è¯¥ç¨‹åºæ–‡ä»¶å®ç°äº†ä¸€ä¸ªåä¸º `VanillaNet` çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œä¸»è¦ç”¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡ï¼Œç‰¹åˆ«æ˜¯ç›®æ ‡æ£€æµ‹å’Œå›¾åƒåˆ†ç±»ã€‚è¯¥æ¨¡å‹æ˜¯åŸºäº YOLOv8 çš„ä¸€ç§æ”¹è¿›ç‰ˆæœ¬ï¼ŒåŒ…å«å¤šä¸ªå¯è°ƒèŠ‚çš„å‚æ•°å’Œå±‚ç»“æ„ï¼Œå…·æœ‰çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚

æ–‡ä»¶å¼€å¤´åŒ…å«ç‰ˆæƒå£°æ˜å’Œè®¸å¯è¯ä¿¡æ¯ï¼Œè¡¨æ˜è¯¥ç¨‹åºéµå¾ª MIT è®¸å¯è¯ï¼Œå¯ä»¥è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ã€‚æ¥ä¸‹æ¥ï¼Œç¨‹åºå¯¼å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬ PyTorch å’Œä¸€äº›ç”¨äºåˆå§‹åŒ–æƒé‡çš„å·¥å…·ã€‚

åœ¨ä»£ç ä¸­ï¼Œé¦–å…ˆå®šä¹‰äº†ä¸€ä¸ª `activation` ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª `nn.ReLU`ï¼Œç”¨äºå®ç°è‡ªå®šä¹‰çš„æ¿€æ´»å‡½æ•°ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°åˆå§‹åŒ–äº†æƒé‡å’Œåç½®ï¼Œå¹¶åŒ…å«äº†å‰å‘ä¼ æ’­æ–¹æ³•ã€‚åœ¨å‰å‘ä¼ æ’­ä¸­ï¼Œå¦‚æœå¤„äºéƒ¨ç½²æ¨¡å¼ï¼Œåˆ™ç›´æ¥è¿›è¡Œå·ç§¯æ“ä½œï¼›å¦åˆ™ï¼Œå…ˆç»è¿‡æ‰¹å½’ä¸€åŒ–å†è¿›è¡Œå·ç§¯ã€‚è¯¥ç±»è¿˜å®ç°äº†æƒé‡èåˆçš„æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨éƒ¨ç½²æ—¶å‡å°‘è®¡ç®—é‡ã€‚

æ¥ç€å®šä¹‰äº†ä¸€ä¸ª `Block` ç±»ï¼Œè¡¨ç¤ºç½‘ç»œä¸­çš„åŸºæœ¬æ„å»ºå—ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°æ ¹æ®æ˜¯å¦å¤„äºéƒ¨ç½²æ¨¡å¼åˆå§‹åŒ–ä¸åŒçš„å·ç§¯å±‚å’Œæ± åŒ–å±‚ã€‚å‰å‘ä¼ æ’­æ–¹æ³•ä¸­ï¼Œè¾“å…¥æ•°æ®ç»è¿‡å·ç§¯ã€æ¿€æ´»å’Œæ± åŒ–æ“ä½œã€‚è¯¥ç±»åŒæ ·å®ç°äº†æƒé‡èåˆå’Œåˆ‡æ¢åˆ°éƒ¨ç½²æ¨¡å¼çš„æ–¹æ³•ã€‚

`VanillaNet` ç±»æ˜¯æ•´ä¸ªæ¨¡å‹çš„æ ¸å¿ƒï¼Œæ„é€ å‡½æ•°ä¸­å®šä¹‰äº†ç½‘ç»œçš„ç»“æ„ï¼ŒåŒ…æ‹¬è¾“å…¥é€šé“ã€ç±»åˆ«æ•°ã€å„å±‚çš„ç»´åº¦å’Œæ­¥å¹…ç­‰ã€‚è¯¥ç±»ä½¿ç”¨ `Block` ç±»æ„å»ºå¤šä¸ªé˜¶æ®µï¼Œå¹¶åœ¨å‰å‘ä¼ æ’­ä¸­å¤„ç†è¾“å…¥æ•°æ®ï¼Œè¿”å›ç‰¹å¾å›¾ã€‚æ¨¡å‹çš„æƒé‡åˆå§‹åŒ–æ–¹æ³•ä¹Ÿåœ¨æ­¤ç±»ä¸­å®šä¹‰ã€‚

åœ¨æ–‡ä»¶çš„ååŠéƒ¨åˆ†ï¼Œå®šä¹‰äº†ä¸€ç³»åˆ—å‡½æ•°ï¼ˆå¦‚ `vanillanet_5` åˆ° `vanillanet_13_x1_5_ada_pool`ï¼‰ï¼Œè¿™äº›å‡½æ•°ç”¨äºåˆ›å»ºä¸åŒé…ç½®çš„ `VanillaNet` æ¨¡å‹ï¼Œæ”¯æŒåŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚

æœ€åï¼Œåœ¨ `__main__` å—ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªè¾“å…¥å¼ é‡å¹¶å®ä¾‹åŒ–äº† `vanillanet_10` æ¨¡å‹ï¼Œéšåè¿›è¡Œå‰å‘ä¼ æ’­å¹¶æ‰“å°è¾“å‡ºç‰¹å¾å›¾çš„å°ºå¯¸ã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¯¥ç¨‹åºæ–‡ä»¶å±•ç¤ºäº†å¦‚ä½•æ„å»ºä¸€ä¸ªçµæ´»çš„ç¥ç»ç½‘ç»œæ¶æ„ï¼Œå¹¶æä¾›äº†å¤šç§æ¨¡å‹é…ç½®ä»¥é€‚åº”ä¸åŒçš„ä»»åŠ¡éœ€æ±‚ã€‚

#### 11.3 ui.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤ï¼Œä½¿ç”¨ streamlit è¿è¡ŒæŒ‡å®šçš„è„šæœ¬
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆ
    result = subprocess.run(command, shell=True)
    
    # æ£€æŸ¥å‘½ä»¤æ‰§è¡Œçš„è¿”å›ç ï¼Œå¦‚æœä¸ä¸º0åˆ™è¡¨ç¤ºå‡ºé”™
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")

# ä¸»ç¨‹åºå…¥å£
if __name__ == "__main__":
    # æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # è¿™é‡Œå¯ä»¥ç›´æ¥æŒ‡å®šè„šæœ¬è·¯å¾„

    # è°ƒç”¨å‡½æ•°è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `sys`ï¼šç”¨äºè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - `subprocess`ï¼šç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **`run_script` å‡½æ•°**ï¼š
   - æ¥æ”¶ä¸€ä¸ªè„šæœ¬è·¯å¾„ä½œä¸ºå‚æ•°ã€‚
   - è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œä»¥ä¾¿åœ¨è¯¥ç¯å¢ƒä¸­è¿è¡Œè„šæœ¬ã€‚
   - æ„å»ºå‘½ä»¤å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ `streamlit` æ¨¡å—è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚
   - ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆã€‚
   - æ£€æŸ¥å‘½ä»¤çš„è¿”å›ç ï¼Œå¦‚æœè¿”å›ç ä¸ä¸º0ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œå‡ºé”™ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯ã€‚

3. **ä¸»ç¨‹åºå…¥å£**ï¼š
   - å½“è„šæœ¬ä½œä¸ºä¸»ç¨‹åºè¿è¡Œæ—¶ï¼ŒæŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼ˆæ­¤å¤„ä¸º `"web.py"`ï¼‰ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶åä¸º `ui.py`ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒè¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ˜¯ä¸€ä¸ªåä¸º `web.py` çš„æ–‡ä»¶ã€‚ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œè¿™äº›æ¨¡å—æä¾›äº†ä¸ç³»ç»Ÿäº¤äº’å’Œæ‰§è¡Œå¤–éƒ¨å‘½ä»¤çš„åŠŸèƒ½ã€‚æ­¤å¤–ï¼Œè¿˜å¯¼å…¥äº† `abs_path` å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯èƒ½ç”¨äºè·å–æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œç¨‹åºæ¥æ”¶ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¯¥å‚æ•°æ˜¯è¦è¿è¡Œçš„è„šæœ¬çš„è·¯å¾„ã€‚å‡½æ•°é¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ Python ç¯å¢ƒæ¥æ‰§è¡Œè„šæœ¬ã€‚æ¥ç€ï¼Œç¨‹åºæ„å»ºäº†ä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œè¯¥å‘½ä»¤ä½¿ç”¨ `streamlit` æ¨¡å—æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚`streamlit` æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºæ•°æ®åº”ç”¨çš„åº“ï¼Œå‘½ä»¤çš„æ ¼å¼ä¸º `python -m streamlit run script_path`ã€‚

éšåï¼Œç¨‹åºä½¿ç”¨ `subprocess.run` æ–¹æ³•æ‰§è¡Œæ„å»ºå¥½çš„å‘½ä»¤ã€‚è¯¥æ–¹æ³•ä¼šåœ¨ä¸€ä¸ªæ–°çš„ shell ä¸­è¿è¡Œå‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆã€‚å¦‚æœå‘½ä»¤æ‰§è¡Œçš„è¿”å›ç ä¸ä¸º 0ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†é”™è¯¯ï¼Œç¨‹åºä¼šæ‰“å°å‡ºç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œç¨‹åºé€šè¿‡ `if __name__ == "__main__":` åˆ¤æ–­æ˜¯å¦æ˜¯ç›´æ¥è¿è¡Œè¯¥è„šæœ¬ã€‚å¦‚æœæ˜¯ï¼Œç¨‹åºä¼šè°ƒç”¨ `abs_path` å‡½æ•°è·å– `web.py` çš„ç»å¯¹è·¯å¾„ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ `run_script` å‡½æ•°ï¼Œä»è€Œå¯åŠ¨è¯¥è„šæœ¬çš„æ‰§è¡Œã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºçš„è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°è¿è¡Œä¸€ä¸ª Streamlit åº”ç”¨ï¼Œç¡®ä¿åœ¨æ­£ç¡®çš„ Python ç¯å¢ƒä¸­æ‰§è¡Œï¼Œå¹¶èƒ½å¤Ÿå¤„ç†å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚

#### 11.4 train.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class DetectionTrainer(BaseTrainer):
    """
    DetectionTrainerç±»ï¼Œç»§æ‰¿è‡ªBaseTrainerç±»ï¼Œç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹çš„è®­ç»ƒã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æ„å»ºYOLOæ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œå¯ä»¥æ˜¯'train'æˆ–'val'ï¼Œç”¨æˆ·å¯ä»¥ä¸ºæ¯ç§æ¨¡å¼è‡ªå®šä¹‰ä¸åŒçš„å¢å¼ºã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…é€‚ç”¨äº'rect'æ¨¡å¼ã€‚é»˜è®¤ä¸ºNoneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æ„é€ å¹¶è¿”å›æ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]  # ç¡®ä¿æ¨¡å¼æ˜¯'train'æˆ–'val'
        with torch_distributed_zero_first(rank):  # åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œä»…åˆå§‹åŒ–æ•°æ®é›†ä¸€æ¬¡
            dataset = self.build_dataset(dataset_path, mode, batch_size)  # æ„å»ºæ•°æ®é›†
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        if getattr(dataset, "rect", False) and shuffle:
            LOGGER.warning("WARNING âš ï¸ 'rect=True'ä¸DataLoaderçš„shuffleä¸å…¼å®¹ï¼Œè®¾ç½®shuffle=False")
            shuffle = False
        workers = self.args.workers if mode == "train" else self.args.workers * 2  # æ ¹æ®æ¨¡å¼è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›æ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹ä¸€æ‰¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # å°†å›¾åƒè½¬ç§»åˆ°è®¾å¤‡å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æœå¯ç”¨å¤šå°ºåº¦
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©æ–°çš„å°ºå¯¸
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:  # å¦‚æœç¼©æ”¾å› å­ä¸ä¸º1
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼ç¼©æ”¾
            batch["img"] = imgs  # æ›´æ–°æ‰¹æ¬¡å›¾åƒ
        return batch

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›YOLOæ£€æµ‹æ¨¡å‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡å‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def get_validator(self):
        """è¿”å›ç”¨äºYOLOæ¨¡å‹éªŒè¯çš„DetectionValidatorã€‚"""
        self.loss_names = "box_loss", "cls_loss", "dfl_loss"  # å®šä¹‰æŸå¤±åç§°
        return yolo.detect.DetectionValidator(
            self.test_loader, save_dir=self.save_dir, args=copy(self.args), _callbacks=self.callbacks
        )  # è¿”å›éªŒè¯å™¨

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )  # ç»˜åˆ¶å›¾åƒå¹¶ä¿å­˜

    def plot_metrics(self):
        """ä»CSVæ–‡ä»¶ä¸­ç»˜åˆ¶æŒ‡æ ‡ã€‚"""
        plot_results(file=self.csv, on_plot=self.on_plot)  # ä¿å­˜ç»“æœå›¾
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è§£é‡Šï¼š
1. **DetectionTrainerç±»**ï¼šè¯¥ç±»è´Ÿè´£è®­ç»ƒYOLOæ£€æµ‹æ¨¡å‹ï¼Œç»§æ‰¿è‡ªåŸºç¡€è®­ç»ƒç±»`BaseTrainer`ã€‚
2. **build_datasetæ–¹æ³•**ï¼šæ„å»ºYOLOæ•°æ®é›†ï¼Œæ”¯æŒè®­ç»ƒå’ŒéªŒè¯æ¨¡å¼ï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰æ•°æ®å¢å¼ºã€‚
3. **get_dataloaderæ–¹æ³•**ï¼šæ„é€ æ•°æ®åŠ è½½å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ã€‚
4. **preprocess_batchæ–¹æ³•**ï¼šå¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å½’ä¸€åŒ–å’Œå¤šå°ºåº¦è°ƒæ•´ã€‚
5. **get_modelæ–¹æ³•**ï¼šè¿”å›YOLOæ£€æµ‹æ¨¡å‹ï¼Œæ”¯æŒåŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
6. **get_validatoræ–¹æ³•**ï¼šè¿”å›ç”¨äºæ¨¡å‹éªŒè¯çš„éªŒè¯å™¨ã€‚
7. **plot_training_sampleså’Œplot_metricsæ–¹æ³•**ï¼šç”¨äºå¯è§†åŒ–è®­ç»ƒæ ·æœ¬å’Œè®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒç›®æ ‡æ£€æµ‹æ¨¡å‹çš„è„šæœ¬ï¼Œä¸»è¦åŸºäº YOLOï¼ˆYou Only Look Onceï¼‰æ¶æ„ã€‚æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º `DetectionTrainer` çš„ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª `BaseTrainer`ï¼Œç”¨äºå®ç° YOLO æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚

åœ¨è¿™ä¸ªç±»ä¸­ï¼Œé¦–å…ˆå®šä¹‰äº† `build_dataset` æ–¹æ³•ï¼Œç”¨äºæ„å»º YOLO æ•°æ®é›†ã€‚è¯¥æ–¹æ³•æ¥æ”¶å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹é‡å¤§å°ä½œä¸ºå‚æ•°ï¼Œåˆ©ç”¨ `build_yolo_dataset` å‡½æ•°åˆ›å»ºæ•°æ®é›†ã€‚æ•°æ®é›†çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œä¼šæ ¹æ®æ¨¡å‹çš„æ­¥å¹…ï¼ˆstrideï¼‰æ¥ç¡®å®šå›¾åƒçš„å¤„ç†æ–¹å¼ã€‚

æ¥ä¸‹æ¥ï¼Œ`get_dataloader` æ–¹æ³•ç”¨äºæ„å»ºæ•°æ®åŠ è½½å™¨ï¼ˆDataLoaderï¼‰ï¼Œå®ƒä¼šæ ¹æ®æŒ‡å®šçš„æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰æ¥åˆå§‹åŒ–æ•°æ®é›†ï¼Œå¹¶è®¾ç½®æ˜¯å¦æ‰“ä¹±æ•°æ®çš„é¡ºåºã€‚è¿™ä¸ªæ–¹æ³•è¿˜ä¼šæ ¹æ®è®­ç»ƒæ¨¡å¼çš„ä¸åŒè°ƒæ•´å·¥ä½œçº¿ç¨‹çš„æ•°é‡ã€‚

`preprocess_batch` æ–¹æ³•è´Ÿè´£å¯¹æ¯ä¸ªæ‰¹æ¬¡çš„å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å°†å›¾åƒç¼©æ”¾åˆ°åˆé€‚çš„å¤§å°å¹¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°æ ¼å¼ã€‚è¿™é‡Œè¿˜å®ç°äº†å¤šå°ºåº¦è®­ç»ƒçš„åŠŸèƒ½ï¼Œé€šè¿‡éšæœºé€‰æ‹©å›¾åƒçš„å¤§å°æ¥å¢å¼ºæ¨¡å‹çš„é²æ£’æ€§ã€‚

`set_model_attributes` æ–¹æ³•ç”¨äºè®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ç­‰ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯æ˜¯ä»æ•°æ®é›†ä¸­æå–çš„ï¼Œå¹¶é™„åŠ åˆ°æ¨¡å‹ä¸­ï¼Œä»¥ä¾¿åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚

`get_model` æ–¹æ³•ç”¨äºè¿”å›ä¸€ä¸ª YOLO æ£€æµ‹æ¨¡å‹çš„å®ä¾‹ï¼Œå¯ä»¥é€‰æ‹©åŠ è½½é¢„è®­ç»ƒçš„æƒé‡ã€‚`get_validator` æ–¹æ³•åˆ™è¿”å›ä¸€ä¸ªç”¨äºæ¨¡å‹éªŒè¯çš„å¯¹è±¡ï¼Œèƒ½å¤Ÿåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ã€‚

`label_loss_items` æ–¹æ³•ç”¨äºè¿”å›ä¸€ä¸ªåŒ…å«è®­ç»ƒæŸå¤±é¡¹çš„å­—å…¸ï¼Œä¾¿äºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç›‘æ§æ¨¡å‹çš„è¡¨ç°ã€‚`progress_string` æ–¹æ³•è¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ˜¾ç¤ºè®­ç»ƒè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰çš„è½®æ¬¡ã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ç­‰ä¿¡æ¯ã€‚

`plot_training_samples` æ–¹æ³•ç”¨äºç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ ‡æ³¨ï¼Œä¾¿äºå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®ã€‚`plot_metrics` å’Œ `plot_training_labels` æ–¹æ³•åˆ™ç”¨äºç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­çš„å„ç§æŒ‡æ ‡å’Œæ ‡ç­¾ï¼Œå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ç†è§£æ¨¡å‹çš„è®­ç»ƒæ•ˆæœã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªæ–‡ä»¶å®ç°äº† YOLO æ¨¡å‹è®­ç»ƒçš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®é›†æ„å»ºã€æ•°æ®åŠ è½½ã€å›¾åƒé¢„å¤„ç†ã€æ¨¡å‹è®¾ç½®ã€æŸå¤±ç›‘æ§å’Œç»“æœå¯è§†åŒ–ç­‰ï¼Œæä¾›äº†ä¸€ä¸ªå®Œæ•´çš„è®­ç»ƒæ¡†æ¶ã€‚

#### 11.5 code\ultralytics\models\__init__.py

ä»¥ä¸‹æ˜¯ä¿ç•™çš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œå¹¶æ·»åŠ äº†è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
# å¯¼å…¥æ‰€éœ€çš„æ¨¡å—
from .rtdetr import RTDETR  # å¯¼å…¥ RTDETR ç±»
from .sam import SAM        # å¯¼å…¥ SAM ç±»
from .yolo import YOLO      # å¯¼å…¥ YOLO ç±»

# å®šä¹‰å¯ä»¥è¢«å¤–éƒ¨è®¿é—®çš„æ¨¡å—æˆå‘˜
__all__ = "YOLO", "RTDETR", "SAM"  # å…è®¸æ›´ç®€å•çš„å¯¼å…¥æ–¹å¼
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š

1. **æ¨¡å—å¯¼å…¥**ï¼š
   - `from .rtdetr import RTDETR`ï¼šä»å½“å‰åŒ…ä¸­å¯¼å…¥ `RTDETR` ç±»ï¼Œé€šå¸¸ç”¨äºç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚
   - `from .sam import SAM`ï¼šä»å½“å‰åŒ…ä¸­å¯¼å…¥ `SAM` ç±»ï¼Œå¯èƒ½æ˜¯ç”¨äºå›¾åƒåˆ†å‰²æˆ–å…¶ä»–ç›¸å…³ä»»åŠ¡ã€‚
   - `from .yolo import YOLO`ï¼šä»å½“å‰åŒ…ä¸­å¯¼å…¥ `YOLO` ç±»ï¼ŒYOLOï¼ˆYou Only Look Onceï¼‰æ˜¯ä¸€ç§æµè¡Œçš„å®æ—¶ç›®æ ‡æ£€æµ‹ç®—æ³•ã€‚

2. **`__all__` å˜é‡**ï¼š
   - `__all__` æ˜¯ä¸€ä¸ªç‰¹æ®Šå˜é‡ï¼Œç”¨äºå®šä¹‰å½“ä½¿ç”¨ `from module import *` è¯­å¥æ—¶ï¼Œå“ªäº›åç§°ä¼šè¢«å¯¼å…¥ã€‚è¿™é‡Œå®šä¹‰äº† `YOLO`ã€`RTDETR` å’Œ `SAM`ï¼Œæ„å‘³ç€è¿™ä¸‰ä¸ªç±»å¯ä»¥è¢«å¤–éƒ¨æ¨¡å—ç›´æ¥å¯¼å…¥ï¼Œç®€åŒ–äº†å¯¼å…¥è¿‡ç¨‹ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªPythonæ¨¡å—çš„åˆå§‹åŒ–æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºå®šä¹‰æ¨¡å—çš„å…¬å…±æ¥å£ã€‚åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œé¦–å…ˆé€šè¿‡æ³¨é‡Šè¯´æ˜äº†è¯¥æ¨¡å—çš„åç§°å’Œè®¸å¯è¯ä¿¡æ¯ï¼Œè¡¨æ˜è¿™æ˜¯Ultralytics YOLOé¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”éµå¾ªAGPL-3.0è®¸å¯è¯ã€‚

æ¥ä¸‹æ¥ï¼Œæ–‡ä»¶å¯¼å…¥äº†ä¸‰ä¸ªç±»æˆ–å‡½æ•°ï¼š`RTDETR`ã€`SAM`å’Œ`YOLO`ï¼Œè¿™äº›éƒ½æ˜¯æ¥è‡ªåŒä¸€ç›®å½•ä¸‹çš„å…¶ä»–æ¨¡å—ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç”¨æˆ·å¯ä»¥åœ¨ä½¿ç”¨è¿™ä¸ªæ¨¡å—æ—¶ç›´æ¥è®¿é—®è¿™äº›ç±»æˆ–å‡½æ•°ï¼Œè€Œä¸éœ€è¦å•ç‹¬å¯¼å…¥å®ƒä»¬æ‰€åœ¨çš„æ–‡ä»¶ã€‚

æœ€åï¼Œ`__all__`å˜é‡è¢«å®šä¹‰ä¸ºä¸€ä¸ªå…ƒç»„ï¼ŒåŒ…å«äº†å­—ç¬¦ä¸²"YOLO"ã€"RTDETR"å’Œ"SAM"ã€‚è¿™ä¸ªå˜é‡çš„ä½œç”¨æ˜¯æ§åˆ¶`from module import *`è¯­å¥çš„è¡Œä¸ºï¼ŒæŒ‡æ˜å½“ä½¿ç”¨è¿™ç§æ–¹å¼å¯¼å…¥æ—¶ï¼Œåªæœ‰è¿™äº›æŒ‡å®šçš„åç§°ä¼šè¢«å¯¼å…¥ï¼Œä»è€Œé¿å…äº†ä¸å¿…è¦çš„åç§°å†²çªæˆ–ä¸å¿…è¦çš„å†…å®¹æš´éœ²ç»™ç”¨æˆ·ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯ç»„ç»‡å’Œç®€åŒ–æ¨¡å—çš„å¯¼å…¥ï¼Œä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿæ›´æ–¹ä¾¿åœ°ä½¿ç”¨Ultralytics YOLOåº“ä¸­çš„ç›¸å…³åŠŸèƒ½ã€‚

#### 11.6 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\solutions\object_counter.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å¹¶æ·»åŠ è¯¦ç»†ä¸­æ–‡æ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
from collections import defaultdict
import cv2
from shapely.geometry import Polygon
from shapely.geometry.point import Point

class ObjectCounter:
    """ç”¨äºå®æ—¶è§†é¢‘æµä¸­å¯¹è±¡è®¡æ•°çš„ç±»ï¼ŒåŸºäºå¯¹è±¡çš„è½¨è¿¹è¿›è¡Œè®¡æ•°ã€‚"""

    def __init__(self):
        """åˆå§‹åŒ–è®¡æ•°å™¨ï¼Œè®¾ç½®é»˜è®¤å€¼ã€‚"""
        # é¼ æ ‡äº‹ä»¶ç›¸å…³
        self.is_drawing = False  # æ˜¯å¦æ­£åœ¨ç»˜åˆ¶
        self.selected_point = None  # é€‰ä¸­çš„ç‚¹

        # åŒºåŸŸä¿¡æ¯
        self.reg_pts = None  # åŒºåŸŸç‚¹
        self.counting_region = None  # è®¡æ•°åŒºåŸŸ
        self.region_color = (255, 255, 255)  # åŒºåŸŸé¢œè‰²

        # å›¾åƒå’Œæ³¨é‡Šä¿¡æ¯
        self.im0 = None  # å½“å‰å›¾åƒ
        self.tf = None  # çº¿æ¡åšåº¦
        self.view_img = False  # æ˜¯å¦æ˜¾ç¤ºå›¾åƒ

        # å¯¹è±¡è®¡æ•°ä¿¡æ¯
        self.in_counts = 0  # è¿›å…¥è®¡æ•°
        self.out_counts = 0  # ç¦»å¼€è®¡æ•°
        self.counting_list = []  # è®¡æ•°åˆ—è¡¨

        # è½¨è¿¹ä¿¡æ¯
        self.track_history = defaultdict(list)  # è½¨è¿¹å†å²
        self.track_thickness = 2  # è½¨è¿¹çº¿æ¡åšåº¦
        self.draw_tracks = False  # æ˜¯å¦ç»˜åˆ¶è½¨è¿¹

    def set_args(self, classes_names, reg_pts, region_color=None, line_thickness=2, track_thickness=2, view_img=False, draw_tracks=False):
        """
        é…ç½®è®¡æ•°å™¨çš„å‚æ•°ï¼ŒåŒ…æ‹¬ç±»åã€åŒºåŸŸç‚¹ã€é¢œè‰²ç­‰ã€‚

        Args:
            classes_names (dict): ç±»åˆ«åç§°
            reg_pts (list): å®šä¹‰è®¡æ•°åŒºåŸŸçš„ç‚¹
            region_color (tuple): åŒºåŸŸçº¿æ¡é¢œè‰²
            line_thickness (int): è¾¹ç•Œæ¡†çº¿æ¡åšåº¦
            track_thickness (int): è½¨è¿¹çº¿æ¡åšåº¦
            view_img (bool): æ˜¯å¦æ˜¾ç¤ºè§†é¢‘æµ
            draw_tracks (bool): æ˜¯å¦ç»˜åˆ¶è½¨è¿¹
        """
        self.tf = line_thickness
        self.view_img = view_img
        self.track_thickness = track_thickness
        self.draw_tracks = draw_tracks
        self.reg_pts = reg_pts
        self.counting_region = Polygon(self.reg_pts)  # åˆ›å»ºè®¡æ•°åŒºåŸŸå¤šè¾¹å½¢
        self.names = classes_names
        self.region_color = region_color if region_color else self.region_color

    def extract_and_process_tracks(self, tracks):
        """
        æå–å¹¶å¤„ç†è½¨è¿¹ï¼Œè¿›è¡Œå¯¹è±¡è®¡æ•°ã€‚

        Args:
            tracks (list): ä»å¯¹è±¡è·Ÿè¸ªè¿‡ç¨‹ä¸­è·å¾—çš„è½¨è¿¹åˆ—è¡¨ã€‚
        """
        boxes = tracks[0].boxes.xyxy.cpu()  # è·å–è¾¹ç•Œæ¡†åæ ‡
        clss = tracks[0].boxes.cls.cpu().tolist()  # è·å–ç±»åˆ«
        track_ids = tracks[0].boxes.id.int().cpu().tolist()  # è·å–è½¨è¿¹ID

        for box, track_id, cls in zip(boxes, track_ids, clss):
            # è®¡ç®—å¯¹è±¡çš„ä¸­å¿ƒç‚¹
            track_line = self.track_history[track_id]
            track_line.append((float((box[0] + box[2]) / 2), float((box[1] + box[3]) / 2)))
            track_line.pop(0) if len(track_line) > 30 else None  # é™åˆ¶è½¨è¿¹é•¿åº¦

            # è®¡æ•°å¯¹è±¡
            if self.counting_region.contains(Point(track_line[-1])):  # æ£€æŸ¥ä¸­å¿ƒç‚¹æ˜¯å¦åœ¨è®¡æ•°åŒºåŸŸå†…
                if track_id not in self.counting_list:  # å¦‚æœæ˜¯æ–°å¯¹è±¡
                    self.counting_list.append(track_id)
                    if box[0] < self.counting_region.centroid.x:  # åˆ¤æ–­å¯¹è±¡æ˜¯è¿›å…¥è¿˜æ˜¯ç¦»å¼€
                        self.out_counts += 1
                    else:
                        self.in_counts += 1

    def start_counting(self, im0, tracks):
        """
        å¯åŠ¨å¯¹è±¡è®¡æ•°è¿‡ç¨‹ã€‚

        Args:
            im0 (ndarray): å½“å‰è§†é¢‘æµå¸§ã€‚
            tracks (list): ä»å¯¹è±¡è·Ÿè¸ªè¿‡ç¨‹ä¸­è·å¾—çš„è½¨è¿¹åˆ—è¡¨ã€‚
        """
        self.im0 = im0  # å­˜å‚¨å½“å‰å›¾åƒ
        if tracks[0].boxes.id is None:  # å¦‚æœæ²¡æœ‰æ£€æµ‹åˆ°å¯¹è±¡ï¼Œè¿”å›
            return
        self.extract_and_process_tracks(tracks)  # æå–å¹¶å¤„ç†è½¨è¿¹
```

### ä»£ç è¯´æ˜ï¼š
1. **ObjectCounterç±»**ï¼šè´Ÿè´£ç®¡ç†å¯¹è±¡è®¡æ•°çš„é€»è¾‘ï¼ŒåŒ…æ‹¬åˆå§‹åŒ–å‚æ•°ã€è®¾ç½®åŒºåŸŸã€å¤„ç†é¼ æ ‡äº‹ä»¶å’Œæå–è½¨è¿¹ã€‚
2. **set_argsæ–¹æ³•**ï¼šç”¨äºé…ç½®è®¡æ•°å™¨çš„å‚æ•°ï¼Œå¦‚ç±»åˆ«åç§°ã€åŒºåŸŸç‚¹ã€é¢œè‰²å’Œçº¿æ¡åšåº¦ç­‰ã€‚
3. **extract_and_process_tracksæ–¹æ³•**ï¼šæå–å¯¹è±¡çš„è½¨è¿¹å¹¶è¿›è¡Œè®¡æ•°ï¼Œåˆ¤æ–­å¯¹è±¡æ˜¯å¦è¿›å…¥æˆ–ç¦»å¼€æŒ‡å®šåŒºåŸŸã€‚
4. **start_countingæ–¹æ³•**ï¼šå¯åŠ¨è®¡æ•°è¿‡ç¨‹ï¼Œå¤„ç†æ¯ä¸€å¸§å›¾åƒå’Œå¯¹åº”çš„è½¨è¿¹æ•°æ®ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºå®æ—¶è§†é¢‘æµä¸­å¯¹è±¡è®¡æ•°çš„ç±»ï¼Œåä¸º`ObjectCounter`ã€‚å®ƒä¾èµ–äºUltralytics YOLOæ¨¡å‹è¿›è¡Œå¯¹è±¡æ£€æµ‹ï¼Œå¹¶ä½¿ç”¨Shapelyåº“å¤„ç†å‡ ä½•å½¢çŠ¶ã€‚ç¨‹åºçš„ä¸»è¦åŠŸèƒ½æ˜¯æ ¹æ®å¯¹è±¡çš„è½¨è¿¹åœ¨æŒ‡å®šåŒºåŸŸå†…è®¡æ•°å¯¹è±¡çš„è¿›å…¥å’Œç¦»å¼€ã€‚

åœ¨ç±»çš„åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œå®šä¹‰äº†ä¸€äº›ç”¨äºå¯¹è±¡è®¡æ•°å’Œè·Ÿè¸ªçš„å‚æ•°ï¼ŒåŒ…æ‹¬é¼ æ ‡äº‹ä»¶çš„å¤„ç†ã€è®¡æ•°åŒºåŸŸçš„ä¿¡æ¯ã€å›¾åƒå’Œæ³¨é‡Šçš„ä¿¡æ¯ã€å¯¹è±¡è®¡æ•°çš„å˜é‡ä»¥åŠè½¨è¿¹çš„å†å²è®°å½•ç­‰ã€‚åˆå§‹åŒ–æ—¶ï¼Œè®¡æ•°åŒºåŸŸçš„ç‚¹ã€é¢œè‰²å’Œå…¶ä»–å‚æ•°éƒ½è¢«è®¾ç½®ä¸ºé»˜è®¤å€¼ã€‚

`set_args`æ–¹æ³•ç”¨äºé…ç½®è®¡æ•°å™¨çš„å‚æ•°ï¼ŒåŒ…æ‹¬ç±»åã€è®¡æ•°åŒºåŸŸçš„ç‚¹ã€åŒºåŸŸé¢œè‰²ã€çº¿æ¡åšåº¦ç­‰ã€‚è¿™äº›å‚æ•°ä¼šå½±å“åˆ°åç»­çš„å¯¹è±¡è®¡æ•°å’Œæ˜¾ç¤ºæ•ˆæœã€‚

`mouse_event_for_region`æ–¹æ³•å¤„ç†é¼ æ ‡äº‹ä»¶ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡é¼ æ ‡åœ¨è§†é¢‘æµä¸­ç»˜åˆ¶å’Œè°ƒæ•´è®¡æ•°åŒºåŸŸã€‚å½“ç”¨æˆ·æŒ‰ä¸‹é¼ æ ‡å·¦é”®æ—¶ï¼Œç¨‹åºä¼šæ£€æŸ¥é¼ æ ‡ä½ç½®æ˜¯å¦æ¥è¿‘è®¡æ•°åŒºåŸŸçš„æŸä¸ªç‚¹ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å…è®¸ç”¨æˆ·æ‹–åŠ¨è¯¥ç‚¹è¿›è¡Œè°ƒæ•´ã€‚

`extract_and_process_tracks`æ–¹æ³•æ˜¯æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œå®ƒæå–ä¼ å…¥çš„è½¨è¿¹æ•°æ®å¹¶è¿›è¡Œå¤„ç†ã€‚é¦–å…ˆï¼Œå®ƒä»è½¨è¿¹ä¸­è·å–è¾¹ç•Œæ¡†ã€ç±»åˆ«å’Œè½¨è¿¹IDï¼Œç„¶åä½¿ç”¨Annotatorç±»åœ¨å›¾åƒä¸Šç»˜åˆ¶è®¡æ•°åŒºåŸŸå’Œå¯¹è±¡çš„è¾¹ç•Œæ¡†ã€‚æ¥ç€ï¼Œç¨‹åºä¼šæ£€æŸ¥æ¯ä¸ªå¯¹è±¡çš„ä¸­å¿ƒç‚¹æ˜¯å¦åœ¨è®¡æ•°åŒºåŸŸå†…ï¼Œå¹¶æ ¹æ®å¯¹è±¡çš„è¿›å…¥å’Œç¦»å¼€æƒ…å†µæ›´æ–°è®¡æ•°ã€‚

å¦‚æœè®¾ç½®äº†`view_img`ä¸ºTrueï¼Œç¨‹åºä¼šåœ¨çª—å£ä¸­æ˜¾ç¤ºå½“å‰å¸§å›¾åƒï¼Œå¹¶åœ¨å›¾åƒä¸Šæ ‡æ³¨è¿›å…¥å’Œç¦»å¼€çš„å¯¹è±¡æ•°é‡ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æŒ‰ä¸‹â€˜qâ€™é”®æ¥é€€å‡ºçª—å£ã€‚

`start_counting`æ–¹æ³•æ˜¯å¯¹è±¡è®¡æ•°çš„ä¸»è¦å…¥å£ï¼Œæ¥æ”¶å½“å‰å¸§å›¾åƒå’Œè½¨è¿¹æ•°æ®ï¼Œå¹¶è°ƒç”¨å¤„ç†æ–¹æ³•è¿›è¡Œè®¡æ•°ã€‚

æœ€åï¼Œç¨‹åºé€šè¿‡`if __name__ == '__main__':`è¯­å¥å¯åŠ¨`ObjectCounter`ç±»çš„å®ä¾‹ï¼Œè¡¨æ˜è¯¥æ–‡ä»¶å¯ä»¥ä½œä¸ºè„šæœ¬ç›´æ¥è¿è¡Œã€‚æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªç¨‹åºæä¾›äº†ä¸€ä¸ªçµæ´»çš„æ¡†æ¶ï¼Œç”¨äºåœ¨è§†é¢‘æµä¸­å®æ—¶è®¡æ•°ç‰¹å®šåŒºåŸŸå†…çš„å¯¹è±¡ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ„æ¶æ¦‚æ‹¬

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºYOLOï¼ˆYou Only Look Onceï¼‰æ¶æ„çš„è®¡ç®—æœºè§†è§‰æ¡†æ¶ï¼Œä¸»è¦ç”¨äºç›®æ ‡æ£€æµ‹ã€å›¾åƒåˆ†ç±»å’Œå¯¹è±¡è®¡æ•°ç­‰ä»»åŠ¡ã€‚é¡¹ç›®çš„æ•´ä½“ç»“æ„åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—è´Ÿè´£ç‰¹å®šçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ¨¡å‹å®šä¹‰ã€è®­ç»ƒã€éªŒè¯ã€æ•°æ®å¤„ç†å’Œç”¨æˆ·ç•Œé¢ç­‰ã€‚ä»¥ä¸‹æ˜¯å„ä¸ªæ¨¡å—çš„ä¸»è¦åŠŸèƒ½ï¼š

- **æ¨¡å‹å®šä¹‰**ï¼šåŒ…æ‹¬YOLOå’Œå…¶ä»–ç½‘ç»œæ¶æ„ï¼ˆå¦‚VanillaNetå’ŒSwinTransformerï¼‰çš„å®ç°ï¼Œæä¾›äº†çµæ´»çš„æ¨¡å‹é…ç½®å’Œé¢„è®­ç»ƒæƒé‡åŠ è½½åŠŸèƒ½ã€‚
- **è®­ç»ƒå’ŒéªŒè¯**ï¼šæä¾›äº†è®­ç»ƒå’ŒéªŒè¯æ¨¡å‹çš„åŠŸèƒ½ï¼Œæ”¯æŒå¤šç§æ•°æ®é›†å’Œè®­ç»ƒå‚æ•°è®¾ç½®ã€‚
- **ç”¨æˆ·ç•Œé¢**ï¼šé€šè¿‡UIæ¨¡å—æä¾›ç”¨æˆ·å‹å¥½çš„ç•Œé¢ï¼Œæ–¹ä¾¿ç”¨æˆ·å¯åŠ¨å’Œç®¡ç†æ¨¡å‹è®­ç»ƒåŠæ¨ç†ã€‚
- **å¯¹è±¡è®¡æ•°**ï¼šå®ç°äº†ä¸€ä¸ªå®æ—¶å¯¹è±¡è®¡æ•°å™¨ï¼Œèƒ½å¤Ÿåœ¨è§†é¢‘æµä¸­ç›‘æµ‹å’Œè®¡æ•°ç‰¹å®šåŒºåŸŸå†…çš„å¯¹è±¡ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                                                 | åŠŸèƒ½æè¿°                                                                                      |
|--------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| `code\ultralytics\models\nas\__init__.py`                              | å®šä¹‰NASæ¨¡å‹çš„å…¬å…±æ¥å£ï¼Œå¯¼å…¥ç›¸å…³ç±»ï¼ˆå¦‚NASã€NASPredictorã€NASValidatorï¼‰ã€‚                    |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\backbone\VanillaNet.py` | å®ç°VanillaNetæ¨¡å‹ï¼Œå®šä¹‰ç½‘ç»œç»“æ„å’Œå‰å‘ä¼ æ’­æ–¹æ³•ï¼Œæ”¯æŒå¤šç§é…ç½®å’Œé¢„è®­ç»ƒæƒé‡åŠ è½½ã€‚              |
| `ui.py`                                                                 | æä¾›ç”¨æˆ·ç•Œé¢ï¼Œé€šè¿‡Streamlitè¿è¡ŒæŒ‡å®šçš„webåº”ç”¨ï¼Œä¾¿äºç”¨æˆ·ä¸æ¨¡å‹äº¤äº’ã€‚                         |
| `train.py`                                                              | å®ç°YOLOæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é›†æ„å»ºã€æ•°æ®åŠ è½½ã€å›¾åƒé¢„å¤„ç†å’ŒæŸå¤±ç›‘æ§ç­‰åŠŸèƒ½ã€‚              |
| `code\ultralytics\models\__init__.py`                                   | å®šä¹‰Ultralyticsæ¨¡å‹çš„å…¬å…±æ¥å£ï¼Œå¯¼å…¥YOLOã€RTDETRå’ŒSAMç­‰ç±»ã€‚                                  |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\solutions\object_counter.py` | å®ç°å®æ—¶å¯¹è±¡è®¡æ•°åŠŸèƒ½ï¼Œèƒ½å¤Ÿåœ¨è§†é¢‘æµä¸­ç›‘æµ‹å’Œè®¡æ•°ç‰¹å®šåŒºåŸŸå†…çš„å¯¹è±¡ã€‚                           |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\nas\val.py` | å®ç°NASæ¨¡å‹çš„éªŒè¯åŠŸèƒ½ï¼Œè¯„ä¼°æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„æ€§èƒ½ã€‚                                          |
| `code\ultralytics\models\yolo\segment\train.py`                        | å®ç°YOLOæ¨¡å‹çš„åˆ†å‰²ä»»åŠ¡è®­ç»ƒï¼Œæ”¯æŒæ•°æ®é›†åŠ è½½å’Œæ¨¡å‹è®­ç»ƒã€‚                                      |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\__init__.py` | å®šä¹‰YOLOæ¨¡å‹çš„å…¬å…±æ¥å£ï¼Œå¯¼å…¥ç›¸å…³ç±»å’Œå‡½æ•°ã€‚                                                  |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\backbone\SwinTransformer.py` | å®ç°Swin Transformeræ¨¡å‹ï¼Œæä¾›ç½‘ç»œç»“æ„å’Œå‰å‘ä¼ æ’­æ–¹æ³•ï¼Œé€‚ç”¨äºå›¾åƒåˆ†ç±»å’Œç›®æ ‡æ£€æµ‹ã€‚           |
| `code\ultralytics\models\yolo\classify\__init__.py`                   | å®šä¹‰YOLOåˆ†ç±»æ¨¡å‹çš„å…¬å…±æ¥å£ï¼Œå¯¼å…¥ç›¸å…³ç±»å’Œå‡½æ•°ã€‚                                              |
| `code\ultralytics\utils\triton.py`                                     | æä¾›ä¸Triton Inference Serverç›¸å…³çš„åŠŸèƒ½ï¼Œæ”¯æŒæ¨¡å‹çš„åœ¨çº¿æ¨ç†å’ŒæœåŠ¡ã€‚                          |
| `code\ultralytics\engine\validator.py`                                  | å®ç°æ¨¡å‹éªŒè¯çš„åŠŸèƒ½ï¼Œè¯„ä¼°æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„æ€§èƒ½ï¼Œè®¡ç®—æŒ‡æ ‡å¦‚å‡†ç¡®ç‡ã€å¬å›ç‡ç­‰ã€‚                  |

è¿™ä¸ªè¡¨æ ¼æ€»ç»“äº†é¡¹ç›®ä¸­å„ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå¸®åŠ©ç†è§£é¡¹ç›®çš„æ•´ä½“ç»“æ„å’Œæ¨¡å—é—´çš„å…³ç³»ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/ZpuWkpdt](https://mbd.pub/o/bread/ZpuWkpdt)